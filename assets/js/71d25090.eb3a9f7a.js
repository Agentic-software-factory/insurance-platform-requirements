"use strict";(globalThis.webpackChunkinsurance_platform_requirements=globalThis.webpackChunkinsurance_platform_requirements||[]).push([[8917],{51598(e,n,s){s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"lessons-learned/LESSON-002-intake-never-runs-next","title":"LESSON-002: Intake Must Never Run /next or Start Workers","description":"Date: 2026-02-10","source":"@site/docs/lessons-learned/LESSON-002-intake-never-runs-next.md","sourceDirName":"lessons-learned","slug":"/lessons-learned/LESSON-002-intake-never-runs-next","permalink":"/insurance-platform-requirements/docs/next/lessons-learned/LESSON-002-intake-never-runs-next","draft":false,"unlisted":false,"editUrl":"https://github.com/Agentic-software-factory/insurance-platform-requirements/edit/main/docs/lessons-learned/LESSON-002-intake-never-runs-next.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"requirementsSidebar","previous":{"title":"LESSON-001: Stale Git Index Causes Local Build Failures","permalink":"/insurance-platform-requirements/docs/next/lessons-learned/LESSON-001-stale-git-index-build-failure"},"next":{"title":"LESSON-003: Intake Must Never Write Files to the Repository","permalink":"/insurance-platform-requirements/docs/next/lessons-learned/LESSON-003-intake-never-writes-files"}}');var t=s(74848),r=s(28453);const l={sidebar_position:3},a="LESSON-002: Intake Must Never Run /next or Start Workers",o={},d=[{value:"Summary",id:"summary",level:2},{value:"Background",id:"background",level:2},{value:"Context",id:"context",level:3},{value:"Assumptions",id:"assumptions",level:3},{value:"What Happened",id:"what-happened",level:2},{value:"Event description",id:"event-description",level:3},{value:"Timeline",id:"timeline",level:3},{value:"Evidence",id:"evidence",level:3},{value:"Root Cause",id:"root-cause",level:2},{value:"Five Whys",id:"five-whys",level:3},{value:"True root cause",id:"true-root-cause",level:3},{value:"Lesson",id:"lesson",level:2},{value:"What we learned",id:"what-we-learned",level:3},{value:"Key insight",id:"key-insight",level:3},{value:"Actions",id:"actions",level:2},{value:"Immediate fixes",id:"immediate-fixes",level:3},{value:"Long-term changes",id:"long-term-changes",level:3},{value:"Documentation updates",id:"documentation-updates",level:3},{value:"Prevention",id:"prevention",level:2},{value:"How to avoid in future",id:"how-to-avoid-in-future",level:3},{value:"Intake session rules",id:"intake-session-rules",level:3},{value:"Correct intake completion message",id:"correct-intake-completion-message",level:3},{value:"Incorrect intake behavior (never do this)",id:"incorrect-intake-behavior-never-do-this",level:3},{value:"Enforcement",id:"enforcement",level:3},{value:"Related Lessons",id:"related-lessons",level:2},{value:"References",id:"references",level:2}];function c(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",input:"input",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"lesson-002-intake-must-never-run-next-or-start-workers",children:"LESSON-002: Intake Must Never Run /next or Start Workers"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Date:"})," 2026-02-10"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Type:"})," Mistake"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Impact:"})," Quality"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Severity:"})," High"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,t.jsxs)(n.p,{children:["An intake session created an issue and then attempted to run ",(0,t.jsx)(n.code,{children:"/next"})," and launch a worker agent to implement it \u2014 violating the separation between intake (creates issues) and workers (implement issues)."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"background",children:"Background"}),"\n",(0,t.jsx)(n.h3,{id:"context",children:"Context"}),"\n",(0,t.jsxs)(n.p,{children:["The delivery factory uses a separation of concerns between intake sessions and worker sessions. Intake sessions read the codebase, talk to the user, and create GitHub issues. Worker sessions pick up issues via ",(0,t.jsx)(n.code,{children:"/next"})," or ",(0,t.jsx)(n.code,{children:"auto-next.sh"})," and implement them autonomously."]}),"\n",(0,t.jsx)(n.h3,{id:"assumptions",children:"Assumptions"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Intake sessions understand their scope is limited to issue creation"}),"\n",(0,t.jsxs)(n.li,{children:["The ",(0,t.jsx)(n.code,{children:"/next"})," command is clearly a worker-only concept"]}),"\n",(0,t.jsx)(n.li,{children:"Session boundaries are self-enforcing"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"what-happened",children:"What Happened"}),"\n",(0,t.jsx)(n.h3,{id:"event-description",children:"Event description"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"User asked the intake session to create an evidence package"}),"\n",(0,t.jsx)(n.li,{children:"Intake correctly created issue #107"}),"\n",(0,t.jsxs)(n.li,{children:['Intake then incorrectly asked "Ska jag k\xf6ra ',(0,t.jsx)(n.code,{children:"/next"}),'?" (Should I run ',(0,t.jsx)(n.code,{children:"/next"}),"?)"]}),"\n",(0,t.jsxs)(n.li,{children:["Intake attempted to launch a ",(0,t.jsx)(n.code,{children:"delivery-factory:code-test"})," agent to implement #107 directly"]}),"\n",(0,t.jsx)(n.li,{children:"User rejected the action and flagged the violation"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"timeline",children:"Timeline"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Intake session created issue #107 for the evidence package"}),"\n",(0,t.jsxs)(n.li,{children:["Immediately after, intake suggested running ",(0,t.jsx)(n.code,{children:"/next"})," to implement the issue"]}),"\n",(0,t.jsx)(n.li,{children:"User intervened and stopped the execution"}),"\n",(0,t.jsx)(n.li,{children:"Violation was identified and documented"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"evidence",children:"Evidence"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Issue #107 was created correctly by intake"}),"\n",(0,t.jsx)(n.li,{children:"Intake session log showed attempt to invoke worker agent"}),"\n",(0,t.jsx)(n.li,{children:"User rejection prevented any implementation from occurring"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"root-cause",children:"Root Cause"}),"\n",(0,t.jsx)(n.h3,{id:"five-whys",children:"Five Whys"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Why did intake try to run /next?"}),"\nThe assistant saw an actionable issue and attempted to be helpful by implementing it immediately."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Why did it think implementing was appropriate?"}),"\nNo explicit boundary rule prevented intake from invoking worker commands."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Why was there no boundary rule?"}),"\nThe separation between intake and worker roles was implicit, not codified in instructions."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Why was it implicit?"}),"\nThe delivery factory pattern was new, and role boundaries had not yet been tested in practice."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Why hadn't it been tested?"}),'\nThis was the first time intake created an issue complex enough to trigger the "helpful implementation" instinct.']}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"true-root-cause",children:"True root cause"}),"\n",(0,t.jsxs)(n.p,{children:['The intake/worker role boundary was assumed but not explicitly enforced. Without a clear rule stating "intake NEVER runs ',(0,t.jsx)(n.code,{children:"/next"}),' or implementation agents," the assistant defaulted to being maximally helpful \u2014 which in this case meant crossing the role boundary.']}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"lesson",children:"Lesson"}),"\n",(0,t.jsx)(n.h3,{id:"what-we-learned",children:"What we learned"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Intake and worker roles must have explicit, codified boundaries"}),"\n",(0,t.jsx)(n.li,{children:'"Be helpful" instincts can violate architectural boundaries if those boundaries are implicit'}),"\n",(0,t.jsxs)(n.li,{children:["The ",(0,t.jsx)(n.code,{children:"/next"})," command and all implementation agents belong exclusively to worker sessions"]}),"\n",(0,t.jsx)(n.li,{children:"Intake sessions are READ-ONLY on the repository \u2014 their only output is GitHub issues"}),"\n",(0,t.jsx)(n.li,{children:"Role separation must be stated as a hard rule, not assumed as convention"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"key-insight",children:"Key insight"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Intake creates issues. Workers implement issues. Never cross that boundary."})," This must be an explicit rule in intake session instructions, not an assumed convention. After creating issues, intake should report what was created and stop \u2014 never suggest or attempt implementation."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"actions",children:"Actions"}),"\n",(0,t.jsx)(n.h3,{id:"immediate-fixes",children:"Immediate fixes"}),"\n",(0,t.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","User rejected the ",(0,t.jsx)(n.code,{children:"/next"})," invocation, preventing any damage"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","Violation identified and flagged for documentation"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"long-term-changes",children:"Long-term changes"}),"\n",(0,t.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","Documented this lesson in ",(0,t.jsx)(n.code,{children:"docs/lessons-learned/"})]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","Updated lessons-learned index"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"documentation-updates",children:"Documentation updates"}),"\n",(0,t.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","Created this lesson file"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ","Updated lessons-learned index"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"prevention",children:"Prevention"}),"\n",(0,t.jsx)(n.h3,{id:"how-to-avoid-in-future",children:"How to avoid in future"}),"\n",(0,t.jsx)(n.h3,{id:"intake-session-rules",children:"Intake session rules"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Intake is READ-ONLY on the repository"}),"\n",(0,t.jsx)(n.li,{children:"Intake output = GitHub Issues only"}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"/next"})," is a worker command \u2014 never suggest or run it from intake"]}),"\n",(0,t.jsxs)(n.li,{children:["Implementation agents (",(0,t.jsx)(n.code,{children:"code-test"}),", ",(0,t.jsx)(n.code,{children:"platform-release"}),", etc.) are worker-only"]}),"\n",(0,t.jsx)(n.li,{children:"After creating issues, intake reports what was created and stops"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"correct-intake-completion-message",children:"Correct intake completion message"}),"\n",(0,t.jsx)(n.p,{children:"After creating issues, the intake session should say:"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:'"Intake complete. N issues created. The worker will handle implementation."'}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"incorrect-intake-behavior-never-do-this",children:"Incorrect intake behavior (never do this)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:['"Shall I run ',(0,t.jsx)(n.code,{children:"/next"}),'?"']}),"\n",(0,t.jsx)(n.li,{children:'"Let me implement this now."'}),"\n",(0,t.jsx)(n.li,{children:'"I\'ll launch a worker agent to handle this."'}),"\n",(0,t.jsxs)(n.li,{children:["Any invocation of ",(0,t.jsx)(n.code,{children:"/next"}),", ",(0,t.jsx)(n.code,{children:"auto-next.sh"}),", or implementation agents"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"enforcement",children:"Enforcement"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Intake session instructions must explicitly forbid ",(0,t.jsx)(n.code,{children:"/next"})," and worker agent invocation"]}),"\n",(0,t.jsx)(n.li,{children:"Code review of intake session prompts should verify this boundary"}),"\n",(0,t.jsx)(n.li,{children:"If intake attempts to cross the boundary, the user should reject and flag it"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"related-lessons",children:"Related Lessons"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/insurance-platform-requirements/docs/next/lessons-learned/LESSON-001-stale-git-index-build-failure",children:"LESSON-001"})," \u2014 Stale Git Index Causes Local Build Failures"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://github.com/Agentic-software-factory/insurance-platform-requirements/issues/107",children:"Issue #107"})," \u2014 Evidence package issue created by intake"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://github.com/Agentic-software-factory/insurance-platform-requirements/issues/109",children:"Issue #109"})," \u2014 This lesson's tracking issue"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Template version:"})," 1.0\n",(0,t.jsx)(n.strong,{children:"Last updated:"})," 2026-02-10"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453(e,n,s){s.d(n,{R:()=>l,x:()=>a});var i=s(96540);const t={},r=i.createContext(t);function l(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);